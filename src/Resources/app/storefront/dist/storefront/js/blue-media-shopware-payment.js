(window.webpackJsonp=window.webpackJsonp||[]).push([["blue-media-shopware-payment"],{VyeF:function(t,e,n){"use strict";n.r(e);var o=n("FGIj");function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function l(t,e){return!e||"object"!==i(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function c(t,e){return(c=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var u,h,f,y=function(t){function e(){return r(this,e),l(this,s(e).apply(this,arguments))}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&c(t,e)}(e,t),n=e,(o=[{key:"init",value:function(){this.currentImage=0,this._getImages(),this._startRotation()}},{key:"_getImages",value:function(){this.images=this.el.querySelectorAll(this.options.imgSelector)}},{key:"_startRotation",value:function(){this.images.length<=1||this.interval||(this.interval=setInterval(this._switchImage.bind(this),this.options.interval))}},{key:"_switchImage",value:function(){this.currentImage>=this.images.length-1?this.currentImage=0:this.currentImage++,this._deactivateImages(),this._activateCurrentImage()}},{key:"_deactivateImages",value:function(){var t=this;this.images.forEach((function(e){e.classList.remove(t.options.activeClass)}))}},{key:"_activateCurrentImage",value:function(){this.images[this.currentImage].classList.add(this.options.activeClass)}}])&&a(n.prototype,o),i&&a(n,i),e}(o.a);f={imgSelector:"img",activeClass:"active",interval:3e3},(h="options")in(u=y)?Object.defineProperty(u,h,{value:f,enumerable:!0,configurable:!0,writable:!0}):u[h]=f;var p=function(){return Boolean(window.ApplePaySession&&ApplePaySession.canMakePayments())};function d(t){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function m(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function b(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function v(t,e){return!e||"object"!==d(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function g(t){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function k(t,e){return(k=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var _=function(t){function e(){return m(this,e),v(this,g(e).apply(this,arguments))}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&k(t,e)}(e,t),n=e,(o=[{key:"init",value:function(){this.isSeparatedPayment=this.el.parentElement.matches(this.options.paymentMethodSelector),this.checkoutConfirmBtn=document.querySelector(this.options.checkoutConfirmBtnSelector),this.paymentMethod=this.el.closest(this.options.paymentMethodSelector),this.gatewayGroup=this.el.closest(this.options.gatewayGroupSelector),this.gateway=this.el.closest(this.options.gatewaySelector),this.gatewaysCollapse=this.gateway&&this.gateway.closest(this.options.collapseSelector),this.collapseBtn=document.querySelector("[data-collapse-checkout-confirm-methods]"),this.collapse=this.paymentMethod&&this.paymentMethod.closest(this.options.collapseSelector),this._handleGatewayVisibility(),this._handlePaymentVisibility()}},{key:"_handleGatewayVisibility",value:function(){this.isSeparatedPayment||p()||this.gateway&&(this.gateway.querySelector("input").checked&&this._disableBtn(this.checkoutConfirmBtn),this._removeNode(this.gateway),this.gatewayGroup&&this._isNodeEmpty(this.gatewaysCollapse)&&this._removeNode(this.gatewayGroup))}},{key:"_handlePaymentVisibility",value:function(){!1===this.isSeparatedPayment||p()||this.paymentMethod&&(this._removeNode(this.paymentMethod),this._handlePaymentCollapse(),0===document.querySelectorAll("".concat(this.options.paymentMethodSelector," input:checked")).length&&this._disableBtn(this.checkoutConfirmBtn))}},{key:"_handlePaymentCollapse",value:function(){this.options.handlePaymentCollapse&&this._isNodeEmpty(this.collapse)&&(this._removeNode(this.collapse),this._removeNode(this.collapseBtn))}},{key:"_removeNode",value:function(t){t.remove()}},{key:"_disableBtn",value:function(t){t.setAttribute("disabled","disabled")}},{key:"_isNodeEmpty",value:function(t){return t instanceof Node&&!t.textContent.trim()}}])&&b(n.prototype,o),i&&b(n,i),e}(o.a);function w(t){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function S(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function C(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function P(t,e){return!e||"object"!==w(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function O(t){return(O=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function E(t,e){return(E=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}!function(t,e,n){e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(_,"options",{paymentMethodSelector:".payment-method",gatewayGroupSelector:".autopay-gateway-group",gatewaySelector:".blue-media-gateway",collapseSelector:".collapse",handlePaymentCollapse:!0,checkoutConfirmBtnSelector:"#confirmFormSubmit"});var B=function(t){function e(){return S(this,e),P(this,O(e).apply(this,arguments))}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&E(t,e)}(e,t),n=e,(o=[{key:"init",value:function(){this._handleInput()}},{key:"_handleInput",value:function(){this.el.matches("input")&&(this.el.value=Number(p()))}}])&&C(n.prototype,o),i&&C(n,i),e}(o.a),M=n("k8s9"),j=n("477Q");function I(t){return(I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function T(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function R(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function A(t,e){return!e||"object"!==I(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function q(t){return(q=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function N(t,e){return(N=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var L=function(t){function e(){return T(this,e),A(this,q(e).apply(this,arguments))}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&N(t,e)}(e,t),n=e,(o=[{key:"init",value:function(){this._client=new M.a,this.form=this.el.closest("form"),this.button=this.el.querySelector(this.options.formSubmitButtonSelector),this.registerEvents()}},{key:"registerEvents",value:function(){var t=this;this.el.addEventListener("submit",(function(e){e.preventDefault(),t.cardOrder()}))}},{key:"cardOrder",value:function(){var t=this;new j.a(this.button).create(),this._client.post(window.router["payment.blue-payment.checkout.card"],new FormData(this.form),(function(e,n){n.status>=400&&window.location.reload();var o=JSON.parse(e);o.transactionContinueRedirect&&PayBmCheckout&&"function"==typeof PayBmCheckout.transactionStartByUrl?(t.registerPayBmEvents(o.finalRedirect,o.checkoutErrorUrl),document.body.classList.add("overflow-hidden"),PayBmCheckout.transactionStartByUrl(o.transactionContinueRedirect)):window.location.replace(o.finalRedirect)}))}},{key:"registerPayBmEvents",value:function(t,e){PayBmCheckout.transactionSuccess=function(){document.body.classList.remove("overflow-hidden"),window.location.replace(t)},PayBmCheckout.transactionDeclined=function(){document.body.classList.remove("overflow-hidden"),window.location.replace(e)},PayBmCheckout.transactionError=function(){document.body.classList.remove("overflow-hidden"),window.location.replace(e)}}}])&&R(n.prototype,o),i&&R(n,i),e}(o.a);function D(t){return(D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function U(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function x(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function F(t,e){return!e||"object"!==D(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function G(t){return(G=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function J(t,e){return(J=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}!function(t,e,n){e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(L,"options",{formSubmitButtonSelector:"#confirmFormSubmit"});var V=function(t){function e(){return U(this,e),F(this,G(e).apply(this,arguments))}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&J(t,e)}(e,t),n=e,(o=[{key:"init",value:function(){this.httpClient=new M.a,this.button=this.el.querySelector(this.options.formSubmitButtonSelector),this.googleClient=null,this.authJwt=null,this.merchantId=null,this.merchantOrigin=null,this.merchantName=null,this.gatewayMerchantId=null,this.allowedAuthMethods=null,this.allowedCardNetworks=null,this.setHandlers(),this.registerEvents()}},{key:"setHandlers",value:function(){this.submitHandler=this.handleSubmit.bind(this)}},{key:"registerEvents",value:function(){this.el.addEventListener("submit",this.submitHandler)}},{key:"handleSubmit",value:function(t){t.preventDefault(),this.googlePayOrder()}},{key:"googlePayOrder",value:function(){new j.a(this.button).create(),this.initGoogleClient()}},{key:"initGoogleClient",value:function(){if("undefined"!=typeof google&&void 0!==google.payments){this.googleClient=new google.payments.api.PaymentsClient({environment:this.options.environment});var t=JSON.stringify({_csrf_token:this.options.bmInitRequest.token});this.httpClient.post(this.options.bmInitRequest.path,t,this.initGoogleClientCallback.bind(this))}}},{key:"initGoogleClientCallback",value:function(t,e){var n=this;e.status>=400&&this.onErrorCallback("Can not collect GooglePay init data! Check configuration!");var o=JSON.parse(t);!0===o.error&&this.onErrorCallback("Can not collect GooglePay init data! Check configuration!"),this.authJwt=o.authJwt,this.merchantId=o.merchantId,this.merchantOrigin=o.merchantOrigin,this.merchantName=o.merchantName,this.allowedAuthMethods=o.allowedAuthMethods,this.allowedCardNetworks=o.allowedCardNetworks,this.gatewayMerchantId=o.gatewayMerchantId,this.googleClient.isReadyToPay(this.getIsReadyToPayRequestData()).then((function(t){t.result?(n.prefetchTransactionData(),n.createPayButton(),n.initiatePaymentWindow()):n.onErrorCallback(t)})).catch((function(t){n.onErrorCallback(t)}))}},{key:"prefetchTransactionData",value:function(){this.googleClient.prefetchPaymentData(this.getPaymentDataRequestData())}},{key:"createPayButton",value:function(){this.googleClient.createButton()}},{key:"initiatePaymentWindow",value:function(){var t=this;this.googleClient.loadPaymentData(this.getPaymentDataRequestData()).then((function(e){t.updatePaymentToken(e.paymentMethodData.tokenizationData.token)})).catch((function(e){t.onErrorCallback(e)})).finally((function(){t.el.removeEventListener("submit",t.submitHandler),t.el.submit()}))}},{key:"getIsReadyToPayRequestData",value:function(){var t=this.getPaymentDataRequestData();return delete t.merchantInfo,delete t.transactionInfo,delete t.shippingAddressRequired,t}},{key:"getPaymentDataRequestData",value:function(){return{apiVersion:2,apiVersionMinor:0,merchantInfo:{merchantId:this.merchantId,merchantOrigin:this.merchantOrigin,merchantName:this.merchantName,authJwt:this.authJwt},allowedPaymentMethods:[{type:"CARD",parameters:{allowedAuthMethods:this.allowedAuthMethods,allowedCardNetworks:this.allowedCardNetworks},tokenizationSpecification:{type:"PAYMENT_GATEWAY",parameters:{gateway:"bluemedia",gatewayMerchantId:this.gatewayMerchantId}}}],transactionInfo:{currencyCode:this.options.transactionCurrencyCode,countryCode:this.options.transactionCountryCode,totalPriceStatus:this.options.transactionStatus,totalPrice:String(this.options.transactionAmount)},shippingAddressRequired:this.options.requireShippingAddress}}},{key:"updatePaymentToken",value:function(t){this.el.querySelector(this.options.paymentTokenSelector).value=JSON.stringify(t)}},{key:"onErrorCallback",value:function(t){console.error(t)}}])&&x(n.prototype,o),i&&x(n,i),e}(o.a);!function(t,e,n){e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(V,"options",{formSubmitButtonSelector:"#confirmFormSubmit",paymentTokenSelector:"#autopay-google-payment-token",environment:"",transactionCurrencyCode:"PLN",transactionCountryCode:"PL",transactionAmount:0,transactionStatus:"FINAL",requireShippingAddress:!1,bmInitRequest:{},autopayGooglePayPaymentOptions:""});var $=n("gHbT"),H=n("2Jwc");function W(t){return(W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function z(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Y(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function Q(t,e){return!e||"object"!==W(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function K(t){return(K=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function X(t,e){return(X=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var Z=function(t){function e(){return z(this,e),Q(this,K(e).apply(this,arguments))}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&X(t,e)}(e,t),n=e,(o=[{key:"_open",value:function(t){this.getModal(),this._modalWrapper.classList.add("blue-media-blik--modal"),this._$modal.on("hidden.bs.modal",this._modalWrapper.remove),this._$modal.on("shown.bs.modal",t),this._$modal.modal({backdrop:"static",keyboard:!1}),this._$modal.modal("show")}}])&&Y(n.prototype,o),i&&Y(n,i),e}(H.a),tt=n("p4AR");function et(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var nt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._client=new tt.a}var e,n,o;return e=t,(n=[{key:"sendBlikTransactionInit",value:function(t,e){this._client.post(window.router["store-api.blue-payment.blik.init"],t,e)}},{key:"sendBlikTransactionCheck",value:function(t,e){this._client.post(window.router["store-api.blue-payment.blik.check"],t,e)}},{key:"sendBlikTransactionRetry",value:function(t,e){this._client.post(window.router["store-api.blue-payment.blik.retry"],t,e)}}])&&et(e.prototype,n),o&&et(e,o),t}();function ot(t){return(ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function it(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function rt(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function at(t,e){return!e||"object"!==ot(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function lt(t){return(lt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function st(t,e){return(st=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}var ct="blikCode",ut=function(t){function e(){return it(this,e),at(this,lt(e).apply(this,arguments))}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&st(t,e)}(e,t),n=e,(o=[{key:"init",value:function(){this._blikClient=new nt,this._blikCodeInput=$.a.querySelector(this.el,"input"),this._blikErrorAlertElement=$.a.querySelector(this.el,this.options.blikErrorAlertSelectors.selector),this._blikCheckStartTime=null,this._registerEvent()}},{key:"_registerEvent",value:function(){$.a.querySelector(document,this.options.checkoutConfirmOrderBtnSelector).addEventListener("click",this._onOrderFormClick.bind(this))}},{key:"_registerModalEvents",value:function(){$.a.querySelector(this._modal.getModal(),this.options.blikModalSelectors.changePaymentButtonSelector).addEventListener("click",this._handleChangePaymentMethodButtonClick.bind(this)),$.a.querySelector(this._modal.getModal(),this.options.blikModalSelectors.blikButtonSelector).addEventListener("click",this._onRetryBlikButtonClick.bind(this))}},{key:"_onOrderFormClick",value:function(t){t.preventDefault(),this._removeError();var e=$.a.querySelector(document,this.options.checkoutConfirmOrderFormSelector);if(e.checkValidity()){this._createButtonLoader(t.currentTarget);var n=new FormData(e);if(!1!==e.reportValidity()){if(n.append(ct,this._blikCodeInput.value),this.options.isOrderEdit)return this._blikClient.sendBlikTransactionRetry(n,this._handleBlikTransactionInit.bind(this));this._blikClient.sendBlikTransactionInit(n,this._handleBlikTransactionInit.bind(this))}}}},{key:"_handleBlikTransactionInit",value:function(t,e){if(200!==e.status){this._buttonLoader.remove();var n=JSON.parse(t);return n.hasOwnProperty("redirectUrl")?void(window.location=n.redirectUrl):void this._createError(n.message)}var o=JSON.parse(t),i=$.a.querySelector(document,this.options.blikModalSelectors.contentSelector);this._modal=new Z(i.outerHTML),this._modal.open(this._handleBlikModal.bind(this,o)),this._waitingModalContent=$.a.querySelector(this._modal.getModal(),this.options.blikModalSelectors.waitingContentSelector),this._errorModalContent=$.a.querySelector(this._modal.getModal(),this.options.blikModalSelectors.errorContentSelector),this._registerModalEvents()}},{key:"_handleBlikModal",value:function(t){this._orderId=t.orderId,this._finishUrl=t.finishUrl,this._sendCheck()}},{key:"_sendCheck",value:function(){null===this._blikCheckStartTime&&(this._blikCheckStartTime=Date.now()),this._blikClient.sendBlikTransactionCheck(JSON.stringify({orderId:this._orderId}),this._handleBlikTransactionCheck.bind(this))}},{key:"_handleBlikTransactionCheck",value:function(t){var e;try{e=JSON.parse(t)}catch(t){return this._modal.close(),this._createError(this.options.generalErrorMessage),this._buttonLoader.remove(),this._blikCheckStartTime=null,console.error(t)}return!0===e.isSuccess&&!1===e.waiting?window.location=this._finishUrl:!0===e.isSuccess&&!0===e.waiting?this._isCheckTimeout()?(this._changePaymentUrl=e.changePaymentUrl,this._toggleBlikError()):setTimeout(this._sendCheck.bind(this),2e3):!1===e.isSuccess?(this._changePaymentUrl=e.changePaymentUrl,this._toggleBlikError()):void 0}},{key:"_onRetryBlikButtonClick",value:function(){this._toggleBlikError();var t=$.a.querySelector(this._modal.getModal(),this.options.blikModalSelectors.blikCodeInputSelector),e=new FormData;e.append("orderId",this._orderId),e.append("paymentMethodId",this.options.paymentMethodId),e.append("finishUrl",this._finishUrl),e.append("errorUrl",this._changePaymentUrl),e.append(ct,t.value),this._blikClient.sendBlikTransactionRetry(e,this._handleRetryBlikTransaction.bind(this))}},{key:"_handleRetryBlikTransaction",value:function(){this._sendCheck()}},{key:"_handleChangePaymentMethodButtonClick",value:function(){window.location=this._changePaymentUrl}},{key:"_toggleBlikError",value:function(){window.PluginManager.initializePlugins(),this._errorModalContent.classList.toggle("d-none"),this._waitingModalContent.classList.toggle("d-none"),this._blikCheckStartTime=null}},{key:"_createError",value:function(t){$.a.querySelector(this._blikErrorAlertElement,this.options.blikErrorAlertSelectors.contentSelector).insertAdjacentHTML("beforeend",t),this._blikErrorAlertElement.classList.remove("d-none"),this._blikErrorAlertElement.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})}},{key:"_removeError",value:function(){this._blikErrorAlertElement.classList.add("d-none")}},{key:"_createButtonLoader",value:function(t){void 0===this._buttonLoader&&(this._buttonLoader=new j.a(t)),this._buttonLoader.create()}},{key:"_isCheckTimeout",value:function(){return Date.now()-this._blikCheckStartTime>7e4}}])&&rt(n.prototype,o),i&&rt(n,i),e}(o.a);function ht(t){return(ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ft(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function yt(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function pt(t,e){return!e||"object"!==ht(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function dt(t){return(dt=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function mt(t,e){return(mt=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}!function(t,e,n){e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n}(ut,"options",{blikTransactionInitUrl:null,isOrderEdit:!1,paymentMethodId:"",blikCodeInputSelector:"#blikCodeInput",checkoutConfirmOrderFormSelector:"#confirmOrderForm",checkoutConfirmOrderBtnSelector:"#confirmFormSubmit",generalErrorMessage:"Unfortunately, an unexpected payment error occurred. Please try again or contact shop support.",blikErrorAlertSelectors:{selector:".blue-media-payment-blik--alert",contentSelector:".alert-content"},blikModalSelectors:{contentSelector:"#blueMediaBlikModalContent",waitingContentSelector:".blue-media-blik--modal-waiting",errorContentSelector:".blue-media-blik--modal-error",blikButtonSelector:"#confirmBlikSubmit",changePaymentButtonSelector:"#changePaymentMethodButton",blikCodeInputSelector:"#blikCodeInput"}});var bt=[new RegExp("^[0-9]$"),new RegExp("^[0-9][0-9]$"),new RegExp("^[0-9][0-9][0-9]$"),new RegExp("^[0-9][0-9][0-9]+\\s$"),new RegExp("^[0-9][0-9][0-9]+\\s[0-9]$"),new RegExp("^[0-9][0-9][0-9]+\\s[0-9][0-9]$"),new RegExp("^[0-9][0-9][0-9]+\\s[0-9][0-9][0-9]$")],vt=function(t){function e(){return ft(this,e),pt(this,dt(e).apply(this,arguments))}var n,o,i;return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&mt(t,e)}(e,t),n=e,(o=[{key:"init",value:function(){this._validateBlik(),this._registerEvents()}},{key:"_registerEvents",value:function(){this.el.addEventListener("keyup",this._validateBlik.bind(this)),this.el.addEventListener("paste",this._validateBlik.bind(this))}},{key:"_validateBlik",value:function(){var t,e,n,o=" "===this.el.value[3],i=this.el.value.length;if(0===i&&(this.el.value=""),i<=7&&i>0){if(i>=4&&!o)return this.el.value=(t=this.el.value,e=" ",n=3,"".concat(t.slice(0,n)).concat(e).concat(t.slice(n))),void this._validateBlik();for(;i>0&&!bt[i-1].test(this.el.value);)this.el.value=this.el.value.slice(0,-1),i=this.el.value.length}else i>=8&&i<=9&&(this.el.value=this.el.value.slice(0,-1));this.el.value.length>=8&&(this.el.value=this.el.value.slice(0,7-this.el.value.length))}}])&&yt(n.prototype,o),i&&yt(n,i),e}(o.a),gt=window.PluginManager;gt.register("BlueMediaImageRotator",y,"[data-autopay-image-rotator]"),gt.register("BlueMediaApplePay",_,"[data-autopay-apple-pay]"),gt.register("BlueMediaApplePayValidationField",B,"[data-autopay-apple-pay-validation-field]"),gt.register("BlueMediaCardPayment",L,"[data-autopay-card-payment]"),gt.register("BlueMediaGooglePayPayment",V,"[data-autopay-google-pay-payment]"),gt.register("BlueMediaBlik",ut,"[data-blue-media-blik]"),gt.register("BlueMediaBlikMask",vt,"[data-blue-media-blik-mask]")}},[["VyeF","runtime","vendor-node","vendor-shared"]]]);